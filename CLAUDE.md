# Claude Code 開発ガイドライン

このドキュメントは、Claude Code を使った効率的なソフトウェア開発のワークフローをまとめたものです。

## 📋 開発フロー

### 1. 準備・計画

- [ ] 既存コードベースの理解（README.md、アーキテクチャ調査）
- [ ] 要件の明確化と TodoWrite でタスクリスト作成
- [ ] ブランチ作成（`feature/`, `fix/`, `chore/`等）
- [ ] 実装方針の決定（技術選択、既存パターンとの整合性）
- [ ] 実装箇所の特定と影響範囲の調査

### 2. 実装

- [ ] 型定義から開始
- [ ] t-wada 流 TDD で段階的実装 (`npm run test:watch`)
- [ ] 既存 conventions に従い、型安全性を重視
- [ ] 保守容易性を30以上維持 (`tsg --json --metrics`)
- [ ] ビルド・テスト確認を継続的に実行

### 3. 完了

- [ ] integration テスト追加・実行 (`npm run test:integration`)
- [ ] 実際の動作確認
- [ ] CLAUDE.md 更新
- [ ] git commit（詳細なメッセージ）
- [ ] プルリクエスト作成

## 🛠️ 技術方針

### コード品質

- **TDD**: 小さなタスクリストを作成し RED-GREEN-REFACTOR を回す
- **DRY原則**: 可読性と疎結合を優先した適度な抽象化
- **既存パターン踏襲**: プロジェクトの conventions を維持
- **Clean stdout**: パイプライン処理に配慮した出力設計

### ツール活用

- **TodoWrite/TodoRead**: タスク管理の徹底
- **Task tool**: 複雑な検索・調査作業
- **Multiple tool calls**: 並列処理による効率化
- **Grep, Glob, Read**: 既存コード調査の戦略的活用

## 📝 品質基準

### 実装品質

- [ ] TypeScript エラーなし
- [ ] 既存テスト通過
- [ ] 新機能テストカバー
- [ ] パフォーマンス影響なし

### ドキュメント品質

- [ ] CLAUDE.md が最新
- [ ] コミットメッセージが詳細
- [ ] PR説明が包括的

### コミットメッセージ形式

**日本語でコミットメッセージを書く**（英単語が含まれても良い）

```
feat: 簡潔で明確なタイトル

詳細な説明：
- 何を実装したか
- なぜその実装を選んだか
- どのような影響があるか

🤖 Generated with [Claude Code](https://claude.ai/code)
Co-Authored-By: Claude <noreply@anthropic.com>
```

---

## 今回の学び（2025-06-28）

### 実装: AI向けJSON出力機能

- **要件**: TypeScript GraphにAI連携用JSON出力機能を追加
- **成果**: `--json`オプションによる構造化データ出力
- **学習ポイント**:
  - stdout汚染防止の重要性（console.log削除）
  - 既存パターンとの整合性（CLI設計、出力方式）
  - 包括的テストの価値（integration test 4シナリオ）
  - DRY原則適用（重複関数呼び出し解消）

### プロセス改善

- **TodoWrite活用**: 7タスクの段階的管理
- **Tool並列実行**: 効率的な情報収集
- **段階的実装**: 小さなステップでの確実な進歩
- **継続的テスト**: 変更の度の動作確認

このワークフローを他プロジェクトでも適用し、継続的に改善していく。
